---
name: ma-pipeline
description: M&A Due Diligence pipeline automation expert. Use for creating Data Rooms, DD checklists, Asana project management, GDrive organization, and deal workflow automation.
---

# M&A Pipeline & Due Diligence Skill

Expert guide for automating M&A workflows, Data Room setup, and Due Diligence management.

## M&A Process Overview

```
DEAL STAGES:
1. Sourcing & Screening     -> Initial target identification
2. NDA & Teaser            -> Confidentiality + summary
3. Initial Due Diligence   -> High-level review
4. LOI (Letter of Intent)  -> Non-binding terms
5. Full Due Diligence      -> Deep dive all areas
6. Purchase Agreement      -> Legal documentation
7. Closing                 -> Transaction completion
8. Integration             -> Post-merger integration
```

## Data Room Structure by Industry

### Standard Template (All Industries)

```
M&A Data Room - [Company Name]/
├── 01. Corporate Documents/
│   ├── 1.1 Formation Documents/
│   │   ├── Certificate of Incorporation
│   │   ├── Bylaws/Operating Agreement
│   │   └── Amendments
│   ├── 1.2 Good Standing Certificates/
│   ├── 1.3 Cap Table & Ownership/
│   │   ├── Shareholder Registry
│   │   ├── Stock Certificates
│   │   └── Option Pool Details
│   └── 1.4 Board & Shareholder Minutes/
│
├── 02. Financial Information/
│   ├── 2.1 Audited Financial Statements/
│   │   ├── Last 3 Years Annual Reports
│   │   └── Audit Letters
│   ├── 2.2 Management Accounts/
│   │   ├── Monthly P&L (24 months)
│   │   ├── Balance Sheets
│   │   └── Cash Flow Statements
│   ├── 2.3 Budget & Projections/
│   │   ├── Current Year Budget
│   │   └── 3-5 Year Projections
│   ├── 2.4 Working Capital Analysis/
│   └── 2.5 Debt Schedule/
│       ├── Loan Agreements
│       └── Repayment Schedules
│
├── 03. Tax Information/
│   ├── 3.1 Tax Returns (3 years)/
│   ├── 3.2 Tax Correspondence/
│   ├── 3.3 Transfer Pricing/
│   └── 3.4 Tax Credits & Incentives/
│
├── 04. Material Contracts/
│   ├── 4.1 Customer Contracts/
│   │   ├── Top 10 Customers
│   │   └── Customer Concentration Analysis
│   ├── 4.2 Supplier Contracts/
│   │   └── Key Suppliers & Terms
│   ├── 4.3 Partnership Agreements/
│   ├── 4.4 JV Agreements/
│   └── 4.5 Franchise/License Agreements/
│
├── 05. Human Resources/
│   ├── 5.1 Organizational Chart/
│   ├── 5.2 Employee Census/
│   │   ├── Headcount by Department
│   │   ├── Compensation Summary
│   │   └── Tenure Analysis
│   ├── 5.3 Employment Agreements/
│   │   ├── Key Executives
│   │   └── Non-Compete/NDA
│   ├── 5.4 Benefit Plans/
│   │   ├── Health Insurance
│   │   ├── 401k/Pension
│   │   └── Stock Options/ESOP
│   └── 5.5 Union Agreements/
│
├── 06. Intellectual Property/
│   ├── 6.1 Patents/
│   ├── 6.2 Trademarks/
│   ├── 6.3 Copyrights/
│   ├── 6.4 Trade Secrets/
│   └── 6.5 IP Licenses/
│
├── 07. Assets & Real Estate/
│   ├── 7.1 Property Deeds/
│   ├── 7.2 Lease Agreements/
│   ├── 7.3 Equipment Lists/
│   ├── 7.4 Vehicle Titles/
│   └── 7.5 Asset Appraisals/
│
├── 08. Legal & Litigation/
│   ├── 8.1 Pending Litigation/
│   ├── 8.2 Settled Cases (3 years)/
│   ├── 8.3 Regulatory Issues/
│   └── 8.4 Insurance Policies/
│
├── 09. Operations/
│   ├── 9.1 Business Overview/
│   │   ├── Company Presentation
│   │   └── Key Metrics Dashboard
│   ├── 9.2 Process Documentation/
│   ├── 9.3 Quality Certifications/
│   │   ├── ISO Certificates
│   │   └── Industry Certifications
│   └── 9.4 Technology Systems/
│       ├── IT Infrastructure
│       └── Software Licenses
│
├── 10. Commercial/
│   ├── 10.1 Sales Pipeline/
│   ├── 10.2 Marketing Materials/
│   ├── 10.3 Competitive Analysis/
│   └── 10.4 Market Research/
│
├── 11. Environmental/
│   ├── 11.1 Environmental Reports/
│   ├── 11.2 Permits & Licenses/
│   └── 11.3 Compliance Audits/
│
└── 12. Transaction Documents/
    ├── 12.1 NDA/
    ├── 12.2 LOI/
    ├── 12.3 Data Room Index/
    └── 12.4 Q&A Log/
```

### Industry-Specific Additions

#### Real Estate
```
├── 13. Real Estate Specific/
│   ├── 13.1 Property Portfolio Summary/
│   ├── 13.2 Rent Rolls/
│   ├── 13.3 Tenant Ledgers/
│   ├── 13.4 CAM Reconciliations/
│   ├── 13.5 Property Condition Reports/
│   ├── 13.6 Phase I Environmental/
│   ├── 13.7 Surveys & Title/
│   └── 13.8 Zoning Certificates/
```

#### Technology/SaaS
```
├── 13. Technology Specific/
│   ├── 13.1 Product Roadmap/
│   ├── 13.2 Technical Architecture/
│   ├── 13.3 Code Repository Access/
│   ├── 13.4 Security Audits (SOC2)/
│   ├── 13.5 Data Privacy (GDPR)/
│   ├── 13.6 SLA Agreements/
│   ├── 13.7 Uptime Reports/
│   └── 13.8 Customer Churn Analysis/
```

#### Healthcare
```
├── 13. Healthcare Specific/
│   ├── 13.1 Licenses & Accreditations/
│   ├── 13.2 HIPAA Compliance/
│   ├── 13.3 Payor Contracts/
│   ├── 13.4 Reimbursement Analysis/
│   ├── 13.5 Clinical Quality Metrics/
│   ├── 13.6 Malpractice History/
│   └── 13.7 Credentialing Files/
```

#### Manufacturing
```
├── 13. Manufacturing Specific/
│   ├── 13.1 Production Capacity/
│   ├── 13.2 Equipment Condition/
│   ├── 13.3 Supply Chain Analysis/
│   ├── 13.4 Inventory Valuation/
│   ├── 13.5 Quality Control Reports/
│   └── 13.6 Safety Records (OSHA)/
```

## Asana Project Template

### Create M&A Project via API

```python
import asana
from asana.rest import ApiException

client = asana.ApiClient(
    configuration=asana.Configuration(
        access_token='YOUR_ACCESS_TOKEN'
    )
)

projects_api = asana.ProjectsApi(client)
tasks_api = asana.TasksApi(client)

# Create project
project = projects_api.create_project({
    'data': {
        'name': f'DD - {company_name}',
        'workspace': workspace_gid,
        'team': team_gid,
        'notes': f'Due Diligence for {company_name} acquisition',
        'color': 'light-blue'
    }
})

# Create sections
sections = [
    'Phase 1: Initial DD',
    'Phase 2: Full DD - Financial',
    'Phase 2: Full DD - Legal',
    'Phase 2: Full DD - Operations',
    'Phase 2: Full DD - HR',
    'Phase 2: Full DD - IT',
    'Phase 3: LOI & Negotiations',
    'Phase 4: Closing',
    'Blockers & Issues',
    'Completed'
]

for section_name in sections:
    asana.SectionsApi(client).create_section_for_project(
        project['gid'],
        {'data': {'name': section_name}}
    )
```

### DD Checklist Tasks

```python
# Financial DD Tasks
financial_tasks = [
    {
        'name': 'Review 3-year audited financials',
        'notes': 'Analyze trends, margins, and anomalies',
        'due_on': due_date(14),
        'assignee': 'finance_lead_gid'
    },
    {
        'name': 'Analyze revenue quality',
        'notes': 'Customer concentration, recurring vs one-time',
        'due_on': due_date(14),
    },
    {
        'name': 'Working capital analysis',
        'notes': 'Calculate normalized working capital',
        'due_on': due_date(21),
    },
    {
        'name': 'Debt and off-balance sheet review',
        'notes': 'Identify all liabilities',
        'due_on': due_date(21),
    },
    {
        'name': 'Quality of Earnings (QoE) review',
        'notes': 'Adjust EBITDA for non-recurring items',
        'due_on': due_date(28),
    },
]

# Legal DD Tasks
legal_tasks = [
    {
        'name': 'Corporate document review',
        'notes': 'Formation docs, good standing, cap table',
        'due_on': due_date(7),
    },
    {
        'name': 'Material contract review',
        'notes': 'Change of control, assignment provisions',
        'due_on': due_date(14),
    },
    {
        'name': 'Litigation review',
        'notes': 'Pending and threatened litigation',
        'due_on': due_date(14),
    },
    {
        'name': 'IP ownership verification',
        'notes': 'Patents, trademarks, licenses',
        'due_on': due_date(21),
    },
    {
        'name': 'Employment agreement review',
        'notes': 'Key executives, non-competes',
        'due_on': due_date(21),
    },
]

# Create all tasks
for task in financial_tasks + legal_tasks:
    tasks_api.create_task({
        'data': {
            **task,
            'projects': [project['gid']],
        }
    })
```

## Google Drive Automation

### Create Data Room Structure

```python
from googleapiclient.discovery import build
from google.oauth2 import credentials

drive_service = build('drive', 'v3', credentials=creds)

def create_folder(name, parent_id=None):
    """Create a folder in Google Drive"""
    metadata = {
        'name': name,
        'mimeType': 'application/vnd.google-apps.folder',
    }
    if parent_id:
        metadata['parents'] = [parent_id]

    folder = drive_service.files().create(
        body=metadata,
        fields='id, webViewLink'
    ).execute()

    return folder

def create_data_room(company_name, template='standard'):
    """Create full Data Room structure"""
    # Create root folder
    root = create_folder(f'Data Room - {company_name}')

    # Define structure based on template
    structure = get_structure_template(template)

    for section, subsections in structure.items():
        section_folder = create_folder(section, root['id'])

        for subsection in subsections:
            create_folder(subsection, section_folder['id'])

    # Set permissions
    drive_service.permissions().create(
        fileId=root['id'],
        body={
            'type': 'domain',
            'role': 'reader',
            'domain': 'yourcompany.com'
        }
    ).execute()

    return root
```

### Upload Documents

```python
from googleapiclient.http import MediaFileUpload

def upload_to_data_room(file_path, folder_id, file_name=None):
    """Upload file to specific Data Room folder"""
    file_name = file_name or os.path.basename(file_path)

    media = MediaFileUpload(
        file_path,
        resumable=True
    )

    file_metadata = {
        'name': file_name,
        'parents': [folder_id]
    }

    uploaded = drive_service.files().create(
        body=file_metadata,
        media_body=media,
        fields='id, webViewLink'
    ).execute()

    return uploaded
```

## DD Checklist Generator

### Generate Excel Checklist

```python
import pandas as pd
from openpyxl import Workbook
from openpyxl.styles import Font, Fill, PatternFill

def generate_dd_checklist(company_name, industry):
    """Generate comprehensive DD checklist Excel"""

    wb = Workbook()

    # Financial DD Sheet
    ws_fin = wb.active
    ws_fin.title = 'Financial DD'

    financial_items = [
        ('Historical Financials', [
            'Audited statements (3 years)',
            'Monthly management accounts (24 months)',
            'Trial balance',
            'Chart of accounts',
        ]),
        ('Revenue Analysis', [
            'Revenue by product/service',
            'Revenue by customer',
            'Revenue by geography',
            'Pricing history',
            'Backlog/pipeline',
        ]),
        ('Profitability', [
            'Gross margin analysis',
            'EBITDA reconciliation',
            'Non-recurring adjustments',
            'Related party transactions',
        ]),
        # ... more categories
    ]

    row = 1
    for category, items in financial_items:
        ws_fin.cell(row, 1, category).font = Font(bold=True)
        row += 1
        for item in items:
            ws_fin.cell(row, 2, item)
            ws_fin.cell(row, 3, 'Pending')  # Status
            ws_fin.cell(row, 4, '')  # Notes
            ws_fin.cell(row, 5, '')  # Responsible
            row += 1
        row += 1

    # Legal DD Sheet
    ws_legal = wb.create_sheet('Legal DD')
    # ... similar structure

    # Save
    filename = f'DD_Checklist_{company_name}_{datetime.now().strftime("%Y%m%d")}.xlsx'
    wb.save(filename)
    return filename
```

## Deal Tracking Dashboard

### Supabase Schema

```sql
-- Deal tracking tables
CREATE TABLE deals (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    company_name VARCHAR(255) NOT NULL,
    industry VARCHAR(100),
    stage VARCHAR(50) DEFAULT 'sourcing',
    enterprise_value DECIMAL(20,2),
    revenue_ltm DECIMAL(20,2),
    ebitda_ltm DECIMAL(20,2),
    ev_revenue_multiple DECIMAL(10,2),
    ev_ebitda_multiple DECIMAL(10,2),
    lead_partner_id UUID REFERENCES users(id),
    data_room_url TEXT,
    asana_project_gid VARCHAR(100),
    notes TEXT,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE TABLE dd_items (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    deal_id UUID REFERENCES deals(id) ON DELETE CASCADE,
    category VARCHAR(100) NOT NULL, -- Financial, Legal, Operations, etc.
    item_name VARCHAR(255) NOT NULL,
    status VARCHAR(50) DEFAULT 'pending',
    priority VARCHAR(20) DEFAULT 'medium',
    assignee_id UUID REFERENCES users(id),
    due_date DATE,
    completed_at TIMESTAMPTZ,
    notes TEXT,
    document_url TEXT,
    created_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE TABLE deal_updates (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    deal_id UUID REFERENCES deals(id) ON DELETE CASCADE,
    update_type VARCHAR(50), -- stage_change, document_received, meeting_held
    title VARCHAR(255),
    content TEXT,
    created_by UUID REFERENCES users(id),
    created_at TIMESTAMPTZ DEFAULT NOW()
);

-- Deal stages enum
ALTER TABLE deals ADD CONSTRAINT deals_stage_check
CHECK (stage IN (
    'sourcing', 'screening', 'nda_signed', 'initial_dd',
    'loi_submitted', 'loi_signed', 'full_dd',
    'negotiation', 'signing', 'closing', 'closed', 'passed'
));
```

## Automation Integrations

### Webhook for Document Upload

```python
from flask import Flask, request
import requests

app = Flask(__name__)

@app.route('/webhook/document-uploaded', methods=['POST'])
def handle_document_upload():
    """Handle new document uploaded to Data Room"""
    data = request.json

    # Update Asana task
    update_asana_task(
        task_gid=data['task_gid'],
        completed=True,
        notes=f"Document uploaded: {data['document_name']}"
    )

    # Send Slack notification
    send_slack_message(
        channel='#deal-updates',
        text=f"New document uploaded to {data['company_name']} Data Room: {data['document_name']}"
    )

    # Update deal tracking
    update_dd_item_status(
        deal_id=data['deal_id'],
        item_name=data['category'],
        status='received'
    )

    return {'status': 'ok'}
```

### Multi-Agent DD Analysis

```javascript
// Use multi-agent for parallel DD analysis
mcp__multi-agent__spawn_agents({
  model: "gemini-3-pro",
  tasks: [
    {
      id: "financial",
      task: "Analyze financial statements for [Company]. Identify revenue trends, margin analysis, and key risks.",
      searchTerms: "financial statements revenue EBITDA"
    },
    {
      id: "legal",
      task: "Review material contracts for change of control provisions and assignment clauses.",
      searchTerms: "contracts legal assignment"
    },
    {
      id: "operations",
      task: "Analyze operational metrics and identify efficiency opportunities.",
      searchTerms: "operations KPIs metrics"
    },
    {
      id: "market",
      task: "Research market position, competitors, and growth opportunities.",
      searchTerms: "market competitors growth"
    }
  ]
})
```

## Best Practices

1. **Standardize naming conventions** - Use consistent folder/file naming
2. **Version control documents** - Date stamp all uploads
3. **Track access** - Log who views what documents
4. **Automate status updates** - Sync Asana/Drive/Slack
5. **Use Q&A logs** - Document all buyer questions
6. **Set clear deadlines** - Phase-based milestones
7. **Regular status calls** - Weekly deal team syncs

## Integration with Other Skills

- **legal-duediligence**: Legal document analysis
- **supabase-expert**: Deal tracking database
- **devops**: Deploy tracking dashboards
- **multi-agent-patterns**: Parallel document analysis
- **security-audit**: Data Room access controls